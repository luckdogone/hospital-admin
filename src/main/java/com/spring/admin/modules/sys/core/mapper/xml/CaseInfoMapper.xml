<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.admin.modules.sys.core.mapper.CaseInfoMapper">
    <sql id="Base_case">
        t.id,
        t.patient_id,
        t.ultrasound_status,
        t.ultrasound_left_size,
        t.ultrasound_left_blood_flow,
        t.ultrasound_left_birads,
        t.ultrasound_right_size,
        t.ultrasound_right_blood_flow,
        t.ultrasound_right_birads,
        t.mammography_status,
        t.mammography_left_size,
        t.mammography_left_aggregation,
        t.mammography_left_birads,
        t.mammography_right_size,
        t.mammography_right_aggregation,
        t.mammography_right_birads,
        t.mri_status,
        t.mri_left_size,
        t.mri_left_blood_flow,
        t.mri_left_birads,
        t.mri_right_size,
        t.mri_right_blood_flow,
        t.mri_right_birads,
        t.wbc,
        t.rbc,
        t.platelets,
        t.alt,
        t.ast,
        t.alkaline_phosphatase,
        t.creatinine,
        t.bun,
        t.uric_acid,
        t.triglycerides,
        t.ldl,
        t.dimer,
        t.cea,
        t.ca153,
        t.ca125,
        t.breast_core_needle,
        t.breast_core_needle_result,
        t.axillary_core_needle,
        t.axillary_core_needle_result,
        t.axillary_fine_needle,
        t.axillary_fine_needle_result,
        t.ihc_result,
        t.er_pct,
        t.pr_pct,
        t.her2,
        t.ki67_pct,
        t.ar_pct,
        t.fish_test,
        t.tnm,
        t.stage,
        t.subtype,
        t.input_status,
        t.created_by,
        t.created,
        t.modified_by,
        t.modified,
        t.is_enable,
        t.is_del
    </sql>
    <select id="queryPage" resultType="com.spring.admin.modules.sys.core.model.entity.CaseInfo">
        SELECT
        <include refid="Base_case"/>
        from case_info t
        WHERE 1=1
        <if test="query.patientId != null and query.patientId != ''">
            and  t.patient_id = #{query.patientId}
        </if>
        <if test="query.inputStatus != null and query.inputStatus != ''">
            and t.input_status = #{query.inputStatus}
        </if>
        <if test="query.isEnable != null">
            and t.is_enable = #{query.isEnable}
        </if>
        <if test="query.isDel != null">
            and t.is_del = #{query.isDel}
        </if>
        order by t.created desc
    </select>

    <select id="getIdsByPatientId" resultType="java.lang.String">
        SELECT t.id
        FROM case_info t
        WHERE t.patient_id = #{patientId}
        <if test="isDel != null">
          AND t.is_del = #{isDel}
        </if>
    </select>
</mapper>
